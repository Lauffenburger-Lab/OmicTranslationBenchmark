library(tidyverse)
library(readxl)
### Load data
human_hiv <- read_xlsx('data/Rv144_Systems_Serology.csv',sheet=1)
### Load data
human_hiv <- read_xlsx('data/Rv144_Systems_Serology.csv',sheet = 1)
### Load data
human_hiv <- read_xlsx('data/Rv144_Systems_Serology.csv',sheet = 1)
### Load data
human_hiv <- read_excel('data/Rv144_Systems_Serology.csv',sheet = 1)
### Load data
human_hiv <- data.table::fread('data/Rv144_Systems_Serology.csv')
View(human_hiv)
colnames(human_hiv)[1] <- 'id'
View(human_hiv)
human_hiv <- human_hiv %>% mutate(trt=ifelse(trt=='PLACEBO',0,1))
human_expr <- human_hiv[,12:ncol(human_hiv)]
View(human_expr)
human_expr <- as.data.frame(human_hiv[,12:ncol(human_hiv)])
hist(human_expr)
View(human_hiv)
View(human_expr)
hist(human_expr)
head(human_expr)
human_expr <- as.data.matrix(human_hiv[,12:ncol(human_hiv)])
hist(human_expr)
human_expr <- as.matrix(human_hiv[,12:ncol(human_hiv)])
hist(human_expr)
mouse_nhp <- read_excel('data/NHP_trial_1319.xlsx',sheet=1)
View(mouse_nhp)
unique(mouse_nhp$Vaccine)
mouse_nhp <- read_excel('data/NHP_trial_1319.xlsx',sheet=1)
mouse_nhp <- mouse_nhp %>% mutate(Vaccine=ifelse(trt=='Sham',0,1))
mouse_nhp <- read_excel('data/NHP_trial_1319.xlsx',sheet=1)
mouse_nhp <- mouse_nhp %>% mutate(Vaccine=ifelse(Vaccine=='Sham',0,1))
mouse_expr <- read_excel('data/NHP_trial_1319.xlsx',sheet=2)
View(mouse_expr)
mouse_expr <- as.matrix(mouse_expr)
hist(human_expr)
hist(mouse_expr)
View(mouse_expr)
View(mouse_expr)
data.table::fread(human_expr,'data/human_exprs.csv',row.names = T)
library(tidyverse)
library(readxl)
### Load data
human_hiv <- data.table::fread('data/Rv144_Systems_Serology.csv')
colnames(human_hiv)[1] <- 'id'
human_hiv <- human_hiv %>% mutate(trt=ifelse(trt=='PLACEBO',0,1))
human_expr <- as.matrix(human_hiv[,12:ncol(human_hiv)])
hist(human_expr)
data.table::fwrite(human_expr,'data/human_exprs.csv',row.names = T)
data.table::fwrite(human_hiv,'data/human_metadata.csv',row.names = T)
mouse_nhp <- read_excel('data/NHP_trial_1319.xlsx',sheet=1)
mouse_nhp <- mouse_nhp %>% mutate(Vaccine=ifelse(Vaccine=='Sham',0,1))
mouse_expr <- read_excel('data/NHP_trial_1319.xlsx',sheet=2)
mouse_expr <- as.matrix(mouse_expr)
hist(mouse_expr)
data.table::fwrite(mouse_expr,'data/mouse_exprs.csv',row.names = T)
data.table::fwrite(mouse_nhp,'data/mouse_metadata.csv',row.names = T)
View(mouse_nhp)
View(human_hiv)
View(mouse_nhp)
View(mouse_nhp)
View(human_hiv)
### Load data
human_hiv <- data.table::fread('data/Rv144_Systems_Serology.csv')
colnames(human_hiv)[1] <- 'id'
human_hiv <- human_hiv %>% mutate(trt=ifelse(trt=='PLACEBO',0,1))
human_hiv <-  human_hiv %>% mutate(infect=ifelse(infect=='yes',0,1))
human_expr <- as.matrix(human_hiv[,12:ncol(human_hiv)])
hist(human_expr)
data.table::fwrite(human_expr,'data/human_exprs.csv',row.names = T)
data.table::fwrite(human_hiv,'data/human_metadata.csv',row.names = T)
mouse_nhp <- read_excel('data/NHP_trial_1319.xlsx',sheet=1)
mouse_nhp <- mouse_nhp %>% mutate(Vaccine=ifelse(Vaccine=='Sham',0,1))
mouse_nhp <-  mouse_nhp %>% mutate(Protection=ifelse(ProtectBinary==1,0,1))
mouse_expr <- read_excel('data/NHP_trial_1319.xlsx',sheet=2)
mouse_expr <- as.matrix(mouse_expr)
hist(mouse_expr)
data.table::fwrite(mouse_expr,'data/mouse_exprs.csv',row.names = T)
data.table::fwrite(mouse_nhp,'data/mouse_metadata.csv',row.names = T)
View(human_hiv)
### Load data
human_hiv <- data.table::fread('data/Rv144_Systems_Serology.csv')
colnames(human_hiv)[1] <- 'id'
human_hiv <- human_hiv %>% mutate(trt=ifelse(trt=='PLACEBO',0,1))
View(human_hiv)
### Load data
human_hiv <- data.table::fread('data/Rv144_Systems_Serology.csv')
colnames(human_hiv)[1] <- 'id'
human_hiv <- human_hiv %>% mutate(trt=ifelse(trt=='PLACEBO',0,1))
human_hiv <-  human_hiv %>% mutate(infect=ifelse(infect=='Yes',0,1))
human_expr <- as.matrix(human_hiv[,12:ncol(human_hiv)])
hist(human_expr)
data.table::fwrite(human_expr,'data/human_exprs.csv',row.names = T)
data.table::fwrite(human_hiv,'data/human_metadata.csv',row.names = T)
mouse_nhp <- read_excel('data/NHP_trial_1319.xlsx',sheet=1)
mouse_nhp <- mouse_nhp %>% mutate(Vaccine=ifelse(Vaccine=='Sham',0,1))
mouse_nhp <-  mouse_nhp %>% mutate(Protection=ifelse(ProtectBinary==1,0,1))
mouse_expr <- read_excel('data/NHP_trial_1319.xlsx',sheet=2)
mouse_expr <- as.matrix(mouse_expr)
hist(mouse_expr)
data.table::fwrite(mouse_expr,'data/mouse_exprs.csv',row.names = T)
data.table::fwrite(mouse_nhp,'data/mouse_metadata.csv',row.names = T)
View(mouse_nhp)
### Load data
human_hiv <- data.table::fread('data/Rv144_Systems_Serology.csv')
colnames(human_hiv)[1] <- 'id'
human_hiv <- human_hiv %>% mutate(trt=ifelse(trt=='PLACEBO',0,1))
human_hiv <-  human_hiv %>% mutate(infect=ifelse(infect=='Yes',0,1))
human_expr <- as.matrix(human_hiv[,12:ncol(human_hiv)])
hist(human_expr)
data.table::fwrite(human_expr,'data/human_exprs.csv',row.names = T)
data.table::fwrite(human_hiv,'data/human_metadata.csv',row.names = T)
mouse_nhp <- read_excel('data/NHP_trial_1319.xlsx',sheet=1)
mouse_nhp <- mouse_nhp %>% mutate(Vaccine=ifelse(Vaccine=='Sham',0,1))
mouse_nhp <-  mouse_nhp %>% mutate(ProtectBinary=ifelse(ProtectBinary==1,0,1))
mouse_expr <- read_excel('data/NHP_trial_1319.xlsx',sheet=2)
mouse_expr <- as.matrix(mouse_expr)
hist(mouse_expr)
data.table::fwrite(mouse_expr,'data/mouse_exprs.csv',row.names = T)
data.table::fwrite(mouse_nhp,'data/mouse_metadata.csv',row.names = T)
View(mouse_nhp)
min(mouse_expr)
max(mouse_expr)
hist(exp(mouse_expr))
hist(2^(mouse_expr))
max(2^(mouse_expr))
min(2^(mouse_expr))
mean(2^(mouse_expr))
t <- 2^(mouse_expr)
View(t)
t <- 10^(mouse_expr)
View(t)
all(int(t)==t)
all(integer(t)==t)
all(as.integer(t)==t)
t <- 2^(mouse_expr)
all(integer(t)==t)
all(as.integer(t)==t)
library(tidyverse)
library(readxl)
### Load data
human_hiv <- data.table::fread('data/Rv144_Systems_Serology.csv')
colnames(human_hiv)[1] <- 'id'
human_hiv <- human_hiv %>% mutate(trt=ifelse(trt=='PLACEBO',0,1))
human_hiv <-  human_hiv %>% mutate(infect=ifelse(infect=='Yes',0,1))
human_expr <- as.matrix(human_hiv[,12:ncol(human_hiv)])
hist(human_expr)
View(human_expr)
tt <- colMeans(human_expr)
View(human_expr)
### Load data
human_hiv <- data.table::fread('data/Rv144_Systems_Serology.csv')
colnames(human_hiv)[1] <- 'id'
human_hiv <- human_hiv %>% mutate(trt=ifelse(trt=='PLACEBO',0,1))
human_hiv <-  human_hiv %>% mutate(infect=ifelse(infect=='Yes',0,1))
human_expr <- as.matrix(human_hiv[,12:ncol(human_hiv)])
cols <- colnames(human_expr)
human_expr <- human_expr - colMeans(human_expr)
View(human_expr)
hist(human_expr)
data.table::fwrite(human_expr,'data/human_exprs.csv',row.names = T)
data.table::fwrite(human_hiv,'data/human_metadata.csv',row.names = T)
mouse_nhp <- read_excel('data/NHP_trial_1319.xlsx',sheet=1)
mouse_nhp <- mouse_nhp %>% mutate(Vaccine=ifelse(Vaccine=='Sham',0,1))
mouse_nhp <-  mouse_nhp %>% mutate(ProtectBinary=ifelse(ProtectBinary==1,0,1))
mouse_expr <- read_excel('data/NHP_trial_1319.xlsx',sheet=2)
mouse_expr <- as.matrix(mouse_expr)
hist(mouse_expr)
mouse_expr <- log10(mouse_expr+0.5)
hist(mouse_expr)
hist(mouse_expr)
min(mouse_expr)
mouse_nhp <- read_excel('data/NHP_trial_1319.xlsx',sheet=1)
mouse_nhp <- mouse_nhp %>% mutate(Vaccine=ifelse(Vaccine=='Sham',0,1))
mouse_nhp <-  mouse_nhp %>% mutate(ProtectBinary=ifelse(ProtectBinary==1,0,1))
mouse_expr <- read_excel('data/NHP_trial_1319.xlsx',sheet=2)
mouse_expr <- as.matrix(mouse_expr)
min(mouse_expr)
mouse_expr <- log10(mouse_expr+1)
hist(mouse_expr)
View(mouse_expr)
which(colnames(mouse_expr)=='ADNK')
mouse_nhp <- read_excel('data/NHP_trial_1319.xlsx',sheet=1)
mouse_nhp <- mouse_nhp %>% mutate(Vaccine=ifelse(Vaccine=='Sham',0,1))
mouse_nhp <-  mouse_nhp %>% mutate(ProtectBinary=ifelse(ProtectBinary==1,0,1))
mouse_expr <- read_excel('data/NHP_trial_1319.xlsx',sheet=2)
mouse_expr <- as.matrix(mouse_expr)
hist(mouse_expr[,which(colnames(mouse_expr)!='ADCD')])
mouse_expr <- mouse_expr - colMeans(mouse_expr)
hist(mouse_expr)
mouse_nhp <- read_excel('data/NHP_trial_1319.xlsx',sheet=1)
mouse_nhp <- mouse_nhp %>% mutate(Vaccine=ifelse(Vaccine=='Sham',0,1))
mouse_nhp <-  mouse_nhp %>% mutate(ProtectBinary=ifelse(ProtectBinary==1,0,1))
mouse_expr <- read_excel('data/NHP_trial_1319.xlsx',sheet=2)
mouse_expr <- as.matrix(mouse_expr)
mouse_expr <- log10(mouse_expr+1)
mouse_expr <- mouse_expr - colMeans(mouse_expr)
hist(mouse_expr)
library(tidyverse)
library(readxl)
### Load data
human_hiv <- data.table::fread('data/Rv144_Systems_Serology.csv')
colnames(human_hiv)[1] <- 'id'
human_hiv <- human_hiv %>% mutate(trt=ifelse(trt=='PLACEBO',0,1))
human_hiv <-  human_hiv %>% mutate(infect=ifelse(infect=='Yes',0,1))
human_expr <- as.matrix(human_hiv[,12:ncol(human_hiv)])
cols <- colnames(human_expr)
human_expr <- human_expr - colMeans(human_expr)
hist(human_expr)
data.table::fwrite(human_expr,'data/human_exprs.csv',row.names = T)
data.table::fwrite(human_hiv,'data/human_metadata.csv',row.names = T)
?scale
library(tidyverse)
library(readxl)
### Load data
human_hiv <- data.table::fread('data/Rv144_Systems_Serology.csv')
colnames(human_hiv)[1] <- 'id'
human_hiv <- human_hiv %>% mutate(trt=ifelse(trt=='PLACEBO',0,1))
human_hiv <-  human_hiv %>% mutate(infect=ifelse(infect=='Yes',0,1))
human_expr <- as.matrix(human_hiv[,12:ncol(human_hiv)])
cols <- colnames(human_expr)
human_expr <- (human_expr - colMeans(human_expr))/apply(human_expr,2,sd)
hist(human_expr)
### Load data
human_hiv <- data.table::fread('data/Rv144_Systems_Serology.csv')
colnames(human_hiv)[1] <- 'id'
human_hiv <- human_hiv %>% mutate(trt=ifelse(trt=='PLACEBO',0,1))
human_hiv <-  human_hiv %>% mutate(infect=ifelse(infect=='Yes',0,1))
human_expr <- as.matrix(human_hiv[,12:ncol(human_hiv)])
cols <- colnames(human_expr)
human_expr <- scale(human_expr)
hist(human_expr)
library(tidyverse)
library(readxl)
### Load data
human_hiv <- data.table::fread('data/Rv144_Systems_Serology.csv')
colnames(human_hiv)[1] <- 'id'
human_hiv <- human_hiv %>% mutate(trt=ifelse(trt=='PLACEBO',0,1))
human_hiv <-  human_hiv %>% mutate(infect=ifelse(infect=='Yes',0,1))
human_expr <- as.matrix(human_hiv[,12:ncol(human_hiv)])
cols <- colnames(human_expr)
# human_expr <- human_expr - colMeans(human_expr)
human_expr <- scale(human_expr)
hist(human_expr)
data.table::fwrite(human_expr,'data/human_exprs.csv',row.names = T)
data.table::fwrite(human_hiv,'data/human_metadata.csv',row.names = T)
mean(human_expr)
sd(human_expr)
mouse_nhp <- read_excel('data/NHP_trial_1319.xlsx',sheet=1)
mouse_nhp <- mouse_nhp %>% mutate(Vaccine=ifelse(Vaccine=='Sham',0,1))
mouse_nhp <-  mouse_nhp %>% mutate(ProtectBinary=ifelse(ProtectBinary==1,0,1))
mouse_expr <- read_excel('data/NHP_trial_1319.xlsx',sheet=2)
mouse_expr <- as.matrix(mouse_expr)
mouse_expr <- log10(mouse_expr+1)
# mouse_expr <- mouse_expr - colMeans(mouse_expr)
mouse_expr <- scale(mouse_expr)
hist(mouse_expr)
data.table::fwrite(mouse_expr,'data/mouse_exprs.csv',row.names = T)
data.table::fwrite(mouse_nhp,'data/mouse_metadata.csv',row.names = T)
View(mouse_expr)
View(human_expr)
library(tidyverse)
library(readxl)
### Load data
human_hiv <- data.table::fread('data/Rv144_Systems_Serology.csv')
colnames(human_hiv)[1] <- 'id'
human_hiv <- human_hiv %>% mutate(trt=ifelse(trt=='PLACEBO',0,1))
human_hiv <-  human_hiv %>% mutate(infect=ifelse(infect=='Yes',0,1))
human_expr <- as.matrix(human_hiv[,12:ncol(human_hiv)])
cols <- colnames(human_expr)
# human_expr <- human_expr - colMeans(human_expr)
human_expr <- scale(human_expr)
hist(human_expr)
data.table::fwrite(human_expr,'data/human_exprs.csv',row.names = T)
data.table::fwrite(human_hiv,'data/human_metadata.csv',row.names = T)
mouse_nhp <- read_excel('data/NHP_trial_1319.xlsx',sheet=1)
mouse_nhp <- mouse_nhp %>% mutate(Vaccine=ifelse(Vaccine=='Sham',0,1))
mouse_nhp <-  mouse_nhp %>% mutate(ProtectBinary=ifelse(ProtectBinary==1,0,1))
mouse_expr <- read_excel('data/NHP_trial_1319.xlsx',sheet=2)
mouse_expr <- as.matrix(mouse_expr)
mouse_expr <- log10(mouse_expr+1)
# mouse_expr <- mouse_expr - colMeans(mouse_expr)
mouse_expr <- scale(mouse_expr)
mouse_expr[which(mouse_expr==NaN)] <- 0.
hist(mouse_expr)
View(human_expr)
data.table::fwrite(mouse_expr,'data/mouse_exprs.csv',row.names = T)
data.table::fwrite(mouse_nhp,'data/mouse_metadata.csv',row.names = T)
mouse_nhp <- read_excel('data/NHP_trial_1319.xlsx',sheet=1)
View(human_expr)
mouse_nhp <- mouse_nhp %>% mutate(Vaccine=ifelse(Vaccine=='Sham',0,1))
mouse_nhp <-  mouse_nhp %>% mutate(ProtectBinary=ifelse(ProtectBinary==1,0,1))
mouse_expr <- read_excel('data/NHP_trial_1319.xlsx',sheet=2)
mouse_expr <- as.matrix(mouse_expr)
mouse_expr <- log10(mouse_expr+1)
View(mouse_expr)
library(tidyverse)
library(readxl)
### Load data
human_hiv <- data.table::fread('data/Rv144_Systems_Serology.csv')
colnames(human_hiv)[1] <- 'id'
human_hiv <- human_hiv %>% mutate(trt=ifelse(trt=='PLACEBO',0,1))
human_hiv <-  human_hiv %>% mutate(infect=ifelse(infect=='Yes',0,1))
human_expr <- as.matrix(human_hiv[,12:ncol(human_hiv)])
cols <- colnames(human_expr)
# human_expr <- human_expr - colMeans(human_expr)
human_expr <- scale(human_expr)
hist(human_expr)
data.table::fwrite(human_expr,'data/human_exprs.csv',row.names = T)
data.table::fwrite(human_hiv,'data/human_metadata.csv',row.names = T)
mouse_nhp <- read_excel('data/NHP_trial_1319.xlsx',sheet=1)
mouse_nhp <- mouse_nhp %>% mutate(Vaccine=ifelse(Vaccine=='Sham',0,1))
mouse_nhp <-  mouse_nhp %>% mutate(ProtectBinary=ifelse(ProtectBinary==1,0,1))
mouse_expr <- read_excel('data/NHP_trial_1319.xlsx',sheet=2)
mouse_expr <- as.matrix(mouse_expr)
mouse_expr <- log10(mouse_expr+1)
# mouse_expr <- mouse_expr - colMeans(mouse_expr)
mouse_expr <- scale(mouse_expr)
mouse_expr[is.nan(mouse_expr)] <- 0.
hist(mouse_expr)
data.table::fwrite(mouse_expr,'data/mouse_exprs.csv',row.names = T)
data.table::fwrite(mouse_nhp,'data/mouse_metadata.csv',row.names = T)
hist(apply(human_expr,2,sd))
max(apply(human_expr,2,sd))
min(apply(human_expr,2,sd))
sd(human_expr)
min(apply(human_expr,1,sd))
hist(apply(human_expr,1,sd))
hist(apply(mouse_expr,1,sd))
hist(apply(mouse_expr,2,sd))
sd(mouse_expr)
library(tidyverse)
library(readxl)
### Load data
human_hiv <- data.table::fread('data/Rv144_Systems_Serology.csv')
colnames(human_hiv)[1] <- 'id'
human_hiv <- human_hiv %>% mutate(trt=ifelse(trt=='PLACEBO',0,1))
human_hiv <-  human_hiv %>% mutate(infect=ifelse(infect=='Yes',0,1))
human_expr <- as.matrix(human_hiv[,12:ncol(human_hiv)])
cols <- colnames(human_expr)
hist(human_expr)
mouse_nhp <- read_excel('data/NHP_trial_1319.xlsx',sheet=1)
mouse_expr <- read_excel('data/NHP_trial_1319.xlsx',sheet=2)
mouse_expr <- as.matrix(mouse_expr)
hist(mouse_expr)
View(mouse_nhp)
### Load data
human_hiv <- data.table::fread('data/Rv144_Systems_Serology.csv')
colnames(human_hiv)[1] <- 'id'
human_hiv <- human_hiv %>% mutate(trt=ifelse(trt=='PLACEBO',0,1))
human_hiv <-  human_hiv %>% mutate(infect=ifelse(infect=='Yes',0,1))
human_expr <- as.matrix(human_hiv[,12:ncol(human_hiv)])
cols <- colnames(human_expr)
# human_expr <- human_expr - colMeans(human_expr)
human_expr <- scale(human_expr)
hist(human_expr)
View(human_expr)
#drop avidity data
cols <- colnames(human_expr)
inds <- grep('avidity',cols)
### Load data
human_hiv <- data.table::fread('data/Rv144_Systems_Serology.csv')
colnames(human_hiv)[1] <- 'id'
human_hiv <- human_hiv %>% mutate(trt=ifelse(trt=='PLACEBO',0,1))
human_hiv <-  human_hiv %>% mutate(infect=ifelse(infect=='Yes',0,1))
human_expr <- as.matrix(human_hiv[,12:ncol(human_hiv)])
#drop avidity data
cols <- colnames(human_expr)
inds <- grep('avidity',cols)
human_expr <- human_expr[,-inds]
cols <- colnames(human_expr)
# human_expr <- human_expr - colMeans(human_expr)
human_expr <- scale(human_expr)
hist(human_expr)
data.table::fwrite(human_expr,'data/human_exprs.csv',row.names = T)
data.table::fwrite(human_hiv,'data/human_metadata.csv',row.names = T)
mouse_nhp <- read_excel('data/NHP_trial_1319.xlsx',sheet=1)
mouse_nhp <- mouse_nhp %>% mutate(Vaccine=ifelse(Vaccine=='Sham',0,1))
mouse_nhp <-  mouse_nhp %>% mutate(ProtectBinary=ifelse(ProtectBinary==1,0,1))
mouse_expr <- read_excel('data/NHP_trial_1319.xlsx',sheet=2)
mouse_expr <- as.matrix(mouse_expr)
View(mouse_expr)
View(human_hiv)
View(mouse_expr)
colnames(mouse_expr)
### keep only Antigen measurements
mouse_expr <- mouse_expr[,30:292]
hist(mouse_expr)
View(mouse_expr)
colnames(mouse_expr)
View(mouse_expr)
View(mouse_nhp)
primates_nhp <- read_excel('data/NHP_trial_1319.xlsx',sheet=1)
primates_nhp <- primates_nhp %>% mutate(Vaccine=ifelse(Vaccine=='Sham',0,1))
primates_nhp <-  primates_nhp %>% mutate(ProtectBinary=ifelse(ProtectBinary==1,0,1))
primates_expr <- read_excel('data/NHP_trial_1319.xlsx',sheet=2)
primates_expr <- as.matrix(primates_expr)
### keep only Antigen measurements
primates_expr <- primates_expr[,30:292]
# 1 to 243 columns MFIs
# normalize by substracting with median of SHAM
controls <- primates_expr[which(primates_nhp)]
# 1 to 243 columns MFIs
# normalize by substracting with median of SHAM
controls <- primates_expr[which(primates_nhp$Immunization_Ag=='Sham'),]
controlsMed <- apply(controls,2,median)
median(contros[,1])
median(controls[,1])
controls[1]
controlsMed[1]
primates_expr <- primates_expr - cotrols
primates_expr <- primates_expr - controlsMed
hist(primates_expr)
primates_nhp <- read_excel('data/NHP_trial_1319.xlsx',sheet=1)
primates_nhp <- primates_nhp %>% mutate(Vaccine=ifelse(Vaccine=='Sham',0,1))
primates_nhp <-  primates_nhp %>% mutate(ProtectBinary=ifelse(ProtectBinary==1,0,1))
primates_expr <- read_excel('data/NHP_trial_1319.xlsx',sheet=2)
primates_expr <- as.matrix(primates_expr)
### keep only Antigen measurements
primates_expr <- primates_expr[,30:292]
# 1 to 243 columns MFIs
# normalize by substracting with median of SHAM
controls <- primates_expr[which(primates_nhp$Immunization_Ag=='Sham'),]
controlsMed <- apply(controls,2,median)
primates_expr <- primates_expr / controlsMed
hist(primates_expr)
primates_nhp <- read_excel('data/NHP_trial_1319.xlsx',sheet=1)
primates_nhp <- primates_nhp %>% mutate(Vaccine=ifelse(Vaccine=='Sham',0,1))
primates_nhp <-  primates_nhp %>% mutate(ProtectBinary=ifelse(ProtectBinary==1,0,1))
primates_expr <- read_excel('data/NHP_trial_1319.xlsx',sheet=2)
primates_expr <- as.matrix(primates_expr)
### keep only Antigen measurements
primates_expr <- primates_expr[,30:292]
# 1 to 243 columns MFIs
# normalize by substracting with median of SHAM
controls <- primates_expr[which(primates_nhp$Immunization_Ag=='Sham'),]
controlsMed <- apply(controls,2,median)
primates_expr <- primates_expr - controlsMed
hist(primates_expr)
View(primates_expr)
primates_expr[,1:243] <- log10(primates_expr[,1:243]+1)
hist(primates_expr)
primates_nhp <- read_excel('data/NHP_trial_1319.xlsx',sheet=1)
primates_nhp <- primates_nhp %>% mutate(Vaccine=ifelse(Vaccine=='Sham',0,1))
primates_nhp <-  primates_nhp %>% mutate(ProtectBinary=ifelse(ProtectBinary==1,0,1))
primates_expr <- read_excel('data/NHP_trial_1319.xlsx',sheet=2)
primates_expr <- as.matrix(primates_expr)
### keep only Antigen measurements
primates_expr <- primates_expr[,30:292]
# 1 to 243 columns MFIs
# normalize by substracting with median of SHAM
controls <- primates_expr[which(primates_nhp$Immunization_Ag=='Sham'),]
controlsMed <- apply(controls,2,median)
primates_expr <- primates_expr - controlsMed
hist(primates_expr)
primates_expr <- log10(primates_expr+1)
hist(primates_expr)
View(primates_expr)
primates_nhp <- read_excel('data/NHP_trial_1319.xlsx',sheet=1)
primates_nhp <- primates_nhp %>% mutate(Vaccine=ifelse(Vaccine=='Sham',0,1))
primates_nhp <-  primates_nhp %>% mutate(ProtectBinary=ifelse(ProtectBinary==1,0,1))
primates_expr <- read_excel('data/NHP_trial_1319.xlsx',sheet=2)
primates_expr <- as.matrix(primates_expr)
### keep only Antigen measurements
primates_expr <- primates_expr[,30:292]
# 1 to 243 columns MFIs
primates_expr <- log10(primates_expr+1)
# normalize by substracting with median of SHAM
controls <- primates_expr[which(primates_nhp$Immunization_Ag=='Sham'),]
controlsMed <- apply(controls,2,median)
primates_expr <- primates_expr - controlsMed
hist(primates_expr)
primates_nhp <- read_excel('data/NHP_trial_1319.xlsx',sheet=1)
primates_nhp <- primates_nhp %>% mutate(Vaccine=ifelse(Vaccine=='Sham',0,1))
primates_nhp <-  primates_nhp %>% mutate(ProtectBinary=ifelse(ProtectBinary==1,0,1))
primates_expr <- read_excel('data/NHP_trial_1319.xlsx',sheet=2)
primates_expr <- as.matrix(primates_expr)
### keep only Antigen measurements
primates_expr <- primates_expr[,30:292]
# 1 to 243 columns MFIs
primates_expr <- log10(primates_expr+1)
# normalize by substracting with median of SHAM
controls <- primates_expr[which(primates_nhp$Immunization_Ag=='Sham'),]
controlsMed <- apply(controls,2,median)
hist(primates_expr)
primates_expr <- primates_expr - controlsMed
hist(primates_expr)
# primates_expr <- primates_expr - colMeans(primates_expr)
primates_expr <- scale(primates_expr)
primates_expr[is.nan(primates_expr)] <- 0.
hist(primates_expr)
data.table::fwrite(primates_expr,'data/primates_exprs.csv',row.names = T)
data.table::fwrite(primates_nhp,'data/primates_metadata.csv',row.names = T)
View(primates_expr)
View(human_expr)
hist(human_expr)
hist(primates_expr)
## Perform PCA
library(factoextra)
pca_primates <- prcomp(primates_expr)
fviz_screeplot(pca_primates)
pca_primates <- prcomp(primates_expr, scale=F)
fviz_screeplot(pca_primates)
pca_humans <- prcomp(primates_humans,scale = F)
pca_humans <- prcomp(human_expr,scale = F)
fviz_screeplot(pca_humans)
